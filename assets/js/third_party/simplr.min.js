(function(){window.simplr={};simplr.dataStorage={};(function(){function c(a,b){return a+"|"+((new Date).getTime()+b)}simplr.cache={set:function(a){var b=a&&a.key||"",g=a&&a.identifier||"",d=a&&a.data||"";a=a&&a.freshness||3155E7;return""!=b?(localStorage.setItem(b+"_time",c(g,a)),localStorage.setItem(b+"_data",d),simplr.cache.get({key:b,identifier:g})):null},get:function(a){var b=a&&a.key||"";a=a&&a.identifier||"";if(""!=b){var g=localStorage.getItem(b+"_time");if(null!=g&&(g=g.split("|"),2==g.length&&
g[0]==a))return(new Date).getTime()<=parseInt(g[1],10)?localStorage.getItem(b+"_data"):simplr.cache.expire(b)}return null},expire:function(a){localStorage.removeItem(a+"_time");localStorage.removeItem(a+"_data");return localStorage.getItem(a+"_data")}}})();(function(){simplr.dataStorage.view={views:{}};simplr.view={add:function(c){for(var a in c)simplr.dataStorage.view.views[a]={html:c[a].html||function(b){return""},callback:c[a].callback||function(b,a){}}},render:function(c){var a=c&&c.name||"",
b=c&&c.data||{};c=c&&c.selector||"";a&&c&&("string"==typeof c?document.querySelector(c).innerHTML=simplr.dataStorage.view.views[a].html(b):c.innerHTML=simplr.dataStorage.view.views[a].html(b),simplr.dataStorage.view.views[a].callback(c,b))}}})();(function(){simplr.dataStorage.command={crud:{view:!0,"new":!0,update:!0,"delete":!0},commands:{}};simplr.command={add:function(c){for(var a in c){var b=c[a]&&c[a].callback||function(){},g=(c[a]&&c[a].route||[]).join("_");g&&(simplr.dataStorage.command.commands[g]=
b)}},execute:function(c){c={route:[],url:c,resources:{},action:"",parameters:{}};"#"==c.url.charAt(0)&&(c.url=c.url.substring(1));"!"==c.url.charAt(0)&&(c.url=c.url.substring(1));var a=c.url.split("?");a[0]=decodeURI(a[0]);a[0]=a[0].split("/");c.action=a[0][a[0].length-1];c.action=simplr.dataStorage.command.crud[c.action]?c.action:"view";for(var b=!0,g="",d=0,e=a[0].length-1;d<e;d++)""!=a[0][d]&&(b?(g=a[0][d],c.route.push(g),c.resources[g]=""):c.resources[g]=a[0][d],b=!b);if(a[1])for(a=a[1].split("&"),
b=0,g=a.length;b<g;b++)d=a[b].split("="),c.parameters[d[0]]=decodeURIComponent(d[1]).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").trim();c.route.push(c.action);a=c.route.join("_");if(simplr.dataStorage.command.commands[a])simplr.dataStorage.command.commands[a](c)}};window.addEventListener("hashchange",function(){simplr.command.execute(window.location.hash)},!1)})();(function(){simplr.dataStorage.template={templates:{}};simplr.template={build:function(c){var a="";if(c&&c.component&&
c.tokens)for(var b="object"==typeof c.tokens&&c.tokens.length?c.tokens:[c.tokens],g=0;g<b.length;g++){var d={},e;for(e in b[g]){var f=d,k=e,h;h=b[g][e];h="object"==typeof h?simplr.template.build(h):h;f[k]=h}f=d;d=c.component;simplr.dataStorage.template.templates[d]||(k=document.getElementById("template-"+d))&&(simplr.dataStorage.template.templates[d]=k.textContent.replace(/\n/g,"").replace(/\s{1,}/g," ").trim());d=simplr.dataStorage.template.templates[d];if(void 0!==d)for(k in k=void 0,f)d=d.replace(new RegExp("\\$\\["+
k+"\\]","g"),escape(f[k]));d=unescape(d);a+=d}return a}}})();(function(){function c(b){return b===document?null:-1!=(" "+b.className+" ").replace(/[\t\r\n\f]/g," ").indexOf(" "+simplr.dataStorage.form.classes.formEntry+" ")?b:c(b.parentNode)}function a(b,a){var c=a,e;for(e in b)c=c.replace(new RegExp("\\$\\["+e+"\\]","g"),escape(b[e]));return unescape(c)}simplr.dataStorage.form={classes:{simplr:"_simplr",formEntry:"formEntry",formError:"formError",fieldError:"errorField",textError:"errorText",textInformation:"informationText"},
defaultRules:["notempty"],defaultLabel:"_LABEL_",rules:{},labels:{},codes:{},validators:{}};simplr.form={addLabelAssociation:function(b){for(var a in b)simplr.dataStorage.form.labels[a]=b[a]},addValidationAssociation:function(b){for(var a in b)simplr.dataStorage.form.rules[a]=b[a]},addValidation:function(b){for(var a in b)simplr.dataStorage.form.validators[a]=b[a]},addCode:function(a){for(var c in a)simplr.dataStorage.form.codes[c]=a[c]},getValues:function(a){var c={};a=a&&"string"==typeof a?document.querySelector(a).querySelectorAll("input, select, textarea"):
a.querySelectorAll("input, select, textarea");for(var d=0;d<a.length;d++){var e=a[d];"button"==e.type||"reset"==e.type||"submit"==e.type||"radio"==e.type&&!e.checked||("checkbox"==e.type?c[e.name]=e.checked?"on"==e.value?!0:e.value.trim():!1:(c[e.name]=e.value,"password"!=e.type&&"file"!=e.type&&(c[e.name]=c[e.name].trim(),e.value=c[e.name])))}return c},validate:function(b,g){var d={},e;for(e in g){for(var f={value:g[e],label:simplr.dataStorage.form.labels[e]?simplr.dataStorage.form.labels[e]:simplr.dataStorage.form.defaultLabel,
rules:[]},k=0;k<simplr.dataStorage.form.defaultRules.length;k++)f.rules.push(simplr.dataStorage.form.defaultRules[k]);if("function"==typeof simplr.dataStorage.form.rules[e])simplr.dataStorage.form.rules[e](f.rules);d[e]=f}var d={data:d||"",valid:!0,codes:{}},h;for(h in d.data){e=d.data[h];d.codes[h]={success:[],error:[]};for(f=0;f<e.rules.length;f++){var k=e.rules[f],l={valid:!0,successCodes:[],errorCodes:[]},l=simplr.dataStorage.form.validators[k]?simplr.dataStorage.form.validators[k](e.value):simplr.dataStorage.form.validators.missingvalidator(e.value),
k=h,m=d;m.codes[k].success=m.codes[k].success.concat(l.successCodes);m.codes[k].error=m.codes[k].error.concat(l.errorCodes);l.valid||(m.valid=!1)}0==d.codes[h].error.length&&0==d.codes[h].success.length&&delete d.codes[h]}h=simplr.dataStorage.form.classes;e=b&&"string"==typeof b?document.querySelector(b):b;k=e.querySelectorAll("."+h.formError+"."+h.simplr+", ."+h.fieldError+"."+h.simplr);for(f=0;f<k.length;f++)k[f].className=k[f].className.replace(h.formError,"").replace(h.fieldError,"").replace(h.simplr,
"");k=e.querySelectorAll("."+h.textInformation+"."+h.simplr+", ."+h.textError+"."+h.simplr);for(f=k.length-1;0<=f;f--)k[f].parentNode.removeChild(k[f]),k[f].className=k[f].className.replace(h.simplr,"");for(var p in d.codes){f=d.codes[p];k=[f.error,f.success];l="";for(f=0;2>f;f++)if(0<k[f].length){var m='<p class="'+(0==f?h.textError:h.textInformation)+" "+h.simplr+'">',n;n=k[f][0];n=simplr.dataStorage.form.codes[n]?a({label:d.data[p].label},simplr.dataStorage.form.codes[n]):a({label:n},"$[label] is UNDEFINED");
l+=m+n+"</p>"}if(f=e.querySelector("[name='"+p+"']"))if(f.className+=" "+h.fieldError+" "+h.simplr,f=c(f))f.className+=" "+h.formError+" "+h.simplr,f.innerHTML+=l}return d.valid}}})();(function(){function c(a,b){if(typeof a==typeof b){if("object"!=typeof a)return a==b;if(a&&void 0!==a.length){if(a.length==b.length){for(var g=0,d=a.length;g<d;g++)if(!c(a[g],b[g]))return!1;return!0}}else{for(g in a)if(!c(a[g],b[g]))return!1;var e=d=0;for(g in a)d++;for(g in b)e++;return d==e}}return!1}simplr.form.addCode({eMissingValidator:"Missing Validator",
eAlphaNumeric:"$[label] is not alphanumeric.",eAmericanExpress:"$[label] is not a valid AMERICAN EXPRESS number.",eDinersClub:"$[label] is not a valid DINERS CLUB number.",eDiscover:"$[label] is not a valid DISCOVER number.",eEmail:"$[label] is not an email address.",eEqual:"$[label] does not match.",eMastercard:"$[label] is not a valid MASTERCARD number.",eEmpty:"$[label] is empty.",eNumber:"$[label] is not a number.",ePhoneNumber:"$[label] is not a valid Phone Number.",ePostalCode:"$[label] is not a Postal Code.",
eVisa:"$[label] is not a valid VISA number."});simplr.form.addValidation({missingvalidator:function(a){return{valid:!1,successCodes:[],errorCodes:["eMissingValidator"]}},alphanumeric:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};/^\w*$/.test(a)||(b.valid=!1,b.errorCodes.push("eAlphaNumeric"));return b},americanexpress:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};/^3(4|7)\d{2}-?\d{6}-?\d{5}$/.test(a)||(b.valid=!1,b.errorCodes.push("eAmericanExpress"));return b},dinersclub:function(a){var b=
{valid:!0,successCodes:[],errorCodes:[]};/^3[0,6,8]\d{12}$/.test(a)||(b.valid=!1,b.errorCodes.push("eDinersClub"));return b},discover:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};/^6011-?\d{4}-?\d{4}-?\d{4}$/.test(a)||(b.valid=!1,b.errorCodes.push("eDiscover"));return b},email:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};/^[a-zA-Z0-9._+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(a)||(b.valid=!1,b.errorCodes.push("eEmail"));return b},equal:function(a){var b={valid:!0,successCodes:[],
errorCodes:[]};if(a&&"object"==typeof a&&void 0!==a.length)for(var g=0;g<a.length;g++)if(!c(a[0],a[g])){b.valid=!1;b.errorCodes.push("eEqual");break}return b},mastercard:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};/^5[1-5]\d{2}-?\d{4}-?\d{4}-?\d{4}$/.test(a)||(b.valid=!1,b.errorCodes.push("eMastercard"));return b},notempty:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};a?"string"==typeof a?b.valid=""!=a.trim():void 0!==a.length&&(b.valid=0!=a.length):b.valid=!1;b.valid||
b.errorCodes.push("eEmpty");return b},number:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};if(isNaN(parseFloat(a))||!isFinite(a))b.valid=!1,b.errorCodes.push("eNumber");return b},phonenumber:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};/^\d{10}$/.test(a)||(b.valid=!1,b.errorCodes.push("ePhoneNumber"));return b},postalcode:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};/^\d{5}([\-]?\d{4})?$/.test(a)||(b.valid=!1,b.errorCodes.push("ePostalCode"));return b},visa:function(a){var b=
{valid:!0,successCodes:[],errorCodes:[]};/^4\d{3}-?\d{4}-?\d{4}-?\d{4}$/.test(a)||(b.valid=!1,b.errorCodes.push("eVisa"));return b}})})()})();